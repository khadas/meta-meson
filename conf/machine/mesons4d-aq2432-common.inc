#@TYPE: Machine
#@NAME: meson

#@DESCRIPTION: Machine configuration for meson systems

include conf/machine/include/mesons4_k5.4_32b.inc
include conf/machine/mesons4-westeros.inc

CHIPSET_NAME = "S805C3"
UBOOT_MACHINE = "s4_aq2432_config"
#Default is EMMC
KERNEL_DEVICETREE = "s4d_s805c3_aq2432_linux_512m.dtb"

MACHINE_EXTRA_RRECOMMENDS:remove = " wififw-qca6174 qca6174"
KERNEL_MODULE_AUTOLOAD:remove = " btqca "
KERNEL_MODULE_PROBECONF:remove = " btqca "
KERNEL_MODULE_AUTOLOAD:remove = " hci_uart"
KERNEL_MODULE_PROBECONF:remove = "hci_uart"

MACHINE_EXTRA_RRECOMMENDS:append = " aml-wifi-w1"

DISTRO_FEATURES:remove = " bt-qca "
DISTRO_FEATURES:append = " aml-w1 aml-wifi "
DISTRO_FEATURES:remove = " netflix amazon tts mediaplayer playready "
DISTRO_FEATURES:remove = " bluetooth bluez5 "

DISTRO_FEATURES:append = " UI_720P low-memory"
DISTRO_FEATURES:append = " appmanager aamp"
DISTRO_FEATURES:append = " arka use-egl arka-project-aml"
DISTRO_FEATURES:append = " webkitbrowser"
DISTRO_FEATURES:append = " fota-upgrade swupdate-download"
DISTRO_FEATURES:append = " remove-test-files"

SYSTEM_DM_VERITY_IMAGE = "${@bb.utils.contains('MULTILIBS', 'multilib:lib32', 'lib32-amlogic-zapperplus', 'amlogic-zapperplus', d)}"

OVERRIDES .= ":aq2432"
TDK_VERSION:s4 = "v3.8/dev/S805C3"

ZRAM_FRACTION = "35"

# For Fota upgrade
DEVICE_PROPERTY_DEVINFO_OEM = "Amlogic"
DEVICE_PROPERTY_DEVINFO_DEVICETYPE = "smarthome"
DEVICE_PROPERTY_DEVINFO_PLATFORM = "A113D"
DEVICE_PROPERTY_DEVINFO_MODELS = "OTT"
DEVICE_PROPERTY_DEVINFO_PRODUCTID = "1660115992"
DEVICE_PROPERTY_DEVINFO_PRODUCTSECRET = "fa7bfc8d755c4c0b8c52fdb00d431d3f"
# End For Fota upgrade

# For YouTube Cert. Now it's for 2024
DEVICE_PROPERTY_FIRMWARE_VERSION = "1.0.0"
DEVICE_PROPERTY_MODEL_NAME = "ZapperPlus"
DEVICE_PROPERTY_OPERATOR_NAME = "SDKRelease"
DEVICE_PROPERTY_YOUTUBE_CERT_SCOPE = "amlogic-2024-zapperplus2024"
DEVICE_PROPERTY_PERSIST_DIALSERVER_NAME="ZapperPlus"
# YouTube define device type
# BDP:   Blu-Ray Player
# GAME:  Game Console
# OTT:   Over-The-Top Device
# STB:   Set-Top-Box, which includes a tuner and demodulator
# TV:    Television Set
DEVICE_PROPERTY_DEVICE_TYPE = "STB"
DEVICE_PROPERTY_CHIPSET = "S805C3"
DEVICE_PROPERTY_MODEL_YEAR = "2024"
DEVICE_PROPERTY_PERSIST_YOUTUBE_FORCE_4K = "n"
DEVICE_PROPERTY_PERSIST_YOUTUBE_MICROPHONE_ENABLED = "n"
DEVICE_PROPERTY_PERSIST_YOUTUBE_TOTAL_CPU_MEMORY = "0xAA00000"
DEVICE_PROPERTY_PERSIST_YOUTUBE_GST_APPSRC_VIDEO_SIZE = "0x400000"
DEVICE_PROPERTY_PERSIST_YOUTUBE_GST_APPSRC_AUDIO_SIZE = "0x100000"
DEVICE_PROPERTY_PERSIST_YOUTUBE_VIDEOSINK_LOWMEM = "y"
DEVICE_PROPERTY_PERSIST_YOUTUBE_SECMEM_SIZE_THRESHOLD = "0x20000"
DEVICE_PROPERTY_PERSIST_YOUTUBE_AUDIO_BUFFERING_LOW_LEVEL = "150000000"
DEVICE_PROPERTY_PERSIST_YOUTUBE_AUDIO_BUFFERING_HIGH_LEVEL = "350000000"
DEVICE_PROPERTY_PERSIST_YOUTUBE_VIDEO_BUFFERING_LOW_LEVEL = "150000000"
DEVICE_PROPERTY_PERSIST_YOUTUBE_VIDEO_BUFFERING_HIGH_LEVEL = "350000000"
DEVICE_PROPERTY_PERSIST_YOUTUBE_VIDEO_MAXBUF_FHD = "0x1900000"
DEVICE_PROPERTY_PERSIST_YOUTUBE_MEDIA_MAXBUF_FHD = "0x2800000"
# End For YouTube

DEVICE_PROPERTY_LAUNCHER_APPS = "arka, youtube, youtubetv, youtubekids"
DEVICE_PROPERTY_STARTUP_APP = "arka"
