include conf/machine/include/mesons4_k5.4_32b.inc
include conf/machine/mesons4d-ap232.inc

KERNEL_MODULE_AUTOLOAD_remove = " cxd2856_fe_64 r836_fe_64 av2018_fe_64 "
KERNEL_MODULE_AUTOLOAD_remove = " hdr10_tmo_alg_64"
KERNEL_MODULE_AUTOLOAD += " cxd2856_fe_32 r836_fe_32 av2018_fe_32 "
KERNEL_MODULE_AUTOLOAD += " hdr10_tmo_alg_32"

DISTRO_FEATURES_append = " irdeto "

# AVB and chained partition
DISTRO_FEATURES_append = " dm-verity AVB_chained_partition "
DEVICE_PROPERTY_BOOT_PARTITION_SIZE = "0x4000000"
DEVICE_PROPERTY_VBMETA_ROLLBACK_INDEX = "0"
DEVICE_PROPERTY_SYSTEM_ROLLBACK_LOCATION = "1"
DEVICE_PROPERTY_VENDOR_ROLLBACK_LOCATION = "2"
# For AVB2 chained partition, the actual signing and root hash information
# are stored in the AVB2 footer of the partition
# Libavb in U-Boot will look at the end of the partition to look for footer.
# Therefore, exact size of the partition has to be specified.
DEVICE_PROPERTY_SYSTEM_PARTITION_SIZE = "0x40000000"
DEVICE_PROPERTY_VENDOR_PARTITION_SIZE = "0x1C000000"
DISTRO_FEATURES_append = " recovery AVB_recovery_partition "
DEVICE_PROPERTY_RECOVERY_ROLLBACK_LOCATION = "3"
DEVICE_PROPERTY_RECOVERY_PARTITION_SIZE = "0x2000000"
# Rollback indexes for system and vendor are supported only if chained
DEVICE_PROPERTY_SYSTEM_ROLLBACK_INDEX = "0"
DEVICE_PROPERTY_VENDOR_ROLLBACK_INDEX = "0"
# For recovery, it is always chained if enabled.
DEVICE_PROPERTY_RECOVERY_ROLLBACK_INDEX = "0"
