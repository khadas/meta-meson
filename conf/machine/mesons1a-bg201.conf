#@TYPE: Machine
#@NAME: meson

#@DESCRIPTION: Machine configuration for meson systems

include conf/machine/include/mesons1a_k5.15_32b.inc
include conf/machine/include/amlogic_nogpu.inc

MACHINE_ESSENTIAL_EXTRA_RRECOMMENDS += " \
        aucpu-fw \
        tuner-prebuilt \
        "

CHIPSET_NAME = "S805C1"
KERNEL_DEVICETREE = "s1a_s805c1_bg201_256m.dtb"
UBOOT_MACHINE = "s1a_bg201"

DISTRO_FEATURES:append = " nand"
#DISTRO_FEATURES:append = " irdeto"
DISTRO_FEATURES:append = " irdeto-ree-only"
ROOTFS_TYPE = "squashfs"

KERNEL_MODULE_AUTOLOAD += " amlogic-socinfo"
KERNEL_MODULE_AUTOLOAD += " amlogic-snd-soc"
KERNEL_MODULE_AUTOLOAD += " amlogic-snd-codec-t9015"
KERNEL_MODULE_AUTOLOAD += " rt710_fe_32 "
KERNEL_MODULE_PROBECONF += "rt710_fe_32"
module_conf_rt710_fe_32 = "options rt710_fe_32  RT710_OUTPUT_MODE=N"

DISTRO_FEATURES:append = " secure-u-boot optee tee-no-videofirmware "
DISTRO_FEATURES:append = " alsa "
DISTRO_FEATURES:append = " aml-dtv "
DISTRO_FEATURES:append = " amlogic-dvb "
DISTRO_FEATURES:append = " recovery "
DISTRO_FEATURES:append = " zapper-2k "
DISTRO_FEATURES:append = " aml-SUB-FB "
DISTRO_FEATURES:append = " dfb "
DISTRO_FEATURES:append = " swupdate "
DISTRO_FEATURES:append = " swupdate-dvb-ota "
DISTRO_FEATURES:append = " dtb-bind-kernel "
DISTRO_FEATURES:append = " arka arka-project-sun arka-launcher arka-hdi"
DISTRO_FEATURES:append = " aml-iptv "
DISTRO_FEATURES:append = " disable-audio-server disable-msync disable-amadec"
DISTRO_FEATURES:append = " disable-binderfs"

DISTRO_FEATURES:remove = " vendor-partition"
DISTRO_FEATURES:remove = " bluetooth wifi ipv6 ipvsec nfc nfs 3g smbfs ppp zeroconf "
DISTRO_FEATURES:remove = " acl xattr pam selinux"
DISTRO_FEATURES:remove = " gpt-partition"
DISTRO_FEATURES:remove = " system-user"
MACHINE_FEATURES:remove = " phone pci pcmcia "
POKY_DEFAULT_DISTRO_FEATURES:remove = " wayland "

TDK_VERSION:s1a = "v3.8/dev/S805C1"
OVERRIDES .= ":bg201"
MACHINEOVERRIDES .= ":client"

# Use sysvinit for system initialization
DISTRO_FEATURES:append = " sysvinit"
DISTRO_FEATURES_BACKFILL_CONSIDERED:append = " systemd"
VIRTUAL-RUNTIME_init_manager = "sysvinit"
VIRTUAL-RUNTIME_initscripts = "initscripts"
VIRTUAL-RUNTIME_login_manager = "busybox"

# remove networking init scripts and configuration files
SYSVINIT_SCRIPTS:remove = " init-ifupdown"
